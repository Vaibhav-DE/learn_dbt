version: 2

sources:
  - name: ecommerce
    database: ultra-sunset-468710-s1    
    schema: customer                    
    description: "Raw ecommerce data loaded from CSVs"
    tables:
      - name: raw_customer
        description: "Raw customers data"
        loaded_at_field: signup_date
        freshness:
          warn_after: {count: 7, period: day}
          error_after: {count: 30, period: day}
        columns:
          - name: customer_id
            tests: [not_null, unique]
          - name: first_name
          - name: last_name
          - name: signup_date
            tests: [not_null]
          - name: country

      - name: raw_orders
        description: "Raw orders data"
        loaded_at_field: order_date
        freshness:
          warn_after: {count: 1, period: day}
          error_after: {count: 2, period: day}
        columns:
          - name: order_id
            tests: [not_null, unique]
          - name: customer_id
            tests: [not_null]
          - name: order_date
            tests: [not_null]
          - name: status
            tests:
              - accepted_values:
                  values: ['placed', 'shipped', 'delivered', 'returned']
          - name: total_amount

      - name: raw_payments
        description: "Raw payments data"
        loaded_at_field: payment_date
        freshness:
          warn_after: {count: 1, period: day}
          error_after: {count: 2, period: day}
        columns:
          - name: payment_id
            tests: [not_null, unique]
          - name: order_id
            tests: [not_null]
          - name: payment_date
            tests: [not_null]
          - name: amount
            tests: [not_null]
          - name: method
            tests:
              - accepted_values:
                  values: ['Credit Card', 'UPI', 'PayPal', 'NetBanking']
